"use strict";(self["webpackChunktest"]=self["webpackChunktest"]||[]).push([[483],{4315:function(e,t,l){l.d(t,{J:function(){return n}});var c=l(821);function n(e,t,l="modelValue"){return(0,c.computed)({get:()=>e[l],set:e=>t(`update:${l}`,e)})}},3744:function(e,t){t.Z=(e,t)=>{const l=e.__vccOpts||e;for(const[c,n]of t)l[c]=n;return l}},1483:function(e,t,l){l.r(t),l.d(t,{default:function(){return _}});var c=l(821);const n=["loading"],o={key:0,class:"grid columns-5 gap-1"},s=["onClick","disabled"],r=["src"],a={key:0,class:"fa fa-check selected-icon position-absolute end-0 bottom-0 icon bg-accent-dk text-white"};function i(e,t,l,i,d,u){const p=(0,c.resolveComponent)("controls");return(0,c.openBlock)(),(0,c.createElementBlock)("div",(0,c.mergeProps)(e.$attrs,{class:"loading-container",loading:i.connection.loading}),[i.connection.results?((0,c.openBlock)(),(0,c.createElementBlock)("div",o,[((0,c.openBlock)(!0),(0,c.createElementBlock)(c.Fragment,null,(0,c.renderList)(i.connection.results.items,(e=>((0,c.openBlock)(),(0,c.createElementBlock)("button",{class:(0,c.normalizeClass)(["d-flex position-relative thumbnail active btn btn-primary-md p-0 rounded-0",{selected:i.selectedIDS.selected.includes(e.ID)}]),onClick:t=>i.selectedIDS.select(e.ID),disabled:!i.selectedIDS.select},[(0,c.createElementVNode)("img",{src:e.url,class:"img-fluid m-auto",style:{height:"100px","object-fit":"cover"}},null,8,r),i.selectedIDS.selected.includes(e.ID)?((0,c.openBlock)(),(0,c.createElementBlock)("i",a)):(0,c.createCommentVNode)("",!0)],10,s)))),256))])):(0,c.createCommentVNode)("",!0),(0,c.createVNode)(p,{class:"mt-1"})],16,n)}var d=l(3806);let u=()=>{let e=async e=>{t.loading=!0,t.failed=!1;try{let l=d.F.crud(e.model).init(e.resource)[e.action];if("function"!=typeof l)throw new Error("Must define a valid action");t.results=await l(e.fields)}catch(l){t.failed=l}t.loading=!1},t=(0,c.reactive)({results:null,loading:!1,failed:!1,load:e});return t},p=e=>{let t=(0,c.reactive)(e),l=()=>{if(t.multiple&&!t.disabled)return()=>r.selected=[...t.options]},n=()=>{if(t.clearable&&!t.disabled)return()=>r.selected=t.multiple?[]:null},o=()=>{if(t.disabled)return;let e=e=>{r.selected=r.selected==e&&t.clearable?null:e},l=e=>{r.selected=d.F.utils.array.toggleValue(r.selected,e)};return t.multiple?l:e},s=(0,c.computed)({get:()=>Array.isArray(t.selected)?t.selected:[t.selected],set:e=>t.selected=e}),r=(0,c.reactive)({selectAll:l(),clearAll:n(),select:o(),selected:s});return r};var m=l(4315);let f={clearable:{type:Boolean,default:!1},selected:{type:[Array,Number,null,Boolean],default:null},multiple:{type:Boolean,default:!1},query:{default:{model:"images",action:"read",resource:{post_type:"attachment",post_mime_type:"image",post_status:"inherit",posts_per_page:20,paged:1},fields:{items:{url:{size:"thumnail"},ID:""},pagination:""}}}},g=(e,t)=>{let l=u(),n=(0,c.reactive)(e.query);(0,c.watch)(n,(()=>l.load(n)),{immediate:!0});let o=(0,c.computed)((()=>l?.result?.items?[]:l.results.items.map((e=>e.ID)))),{clearable:s,selected:r,multiple:a}=(0,c.toRefs)(e),i=p({clearable:s,selected:r,multiple:a,selected:(0,m.J)(e,t.emit,"selected"),options:o}),d={connection:l,selectedIDS:i,query:n};return(0,c.provide)("wp-object-selector",d),d};const b={key:0},k={class:"d-flex gap-1"},v={class:"d-flex gap-1 flex-grow-1"},y=["disabled"],h=["value"],D=["disabled"],B={class:"grid gap-1 columns-2 flex-shrink-1"},I=["disabled"],E=["disabled"];function w(e,t,l,n,o,s){const r=(0,c.resolveDirective)("tooltip");return e.connection.results?((0,c.openBlock)(),(0,c.createElementBlock)("div",b,[(0,c.createElementVNode)("div",k,[(0,c.createElementVNode)("div",v,[(0,c.withDirectives)((0,c.createElementVNode)("button",{class:"fa fa-chevron-left btn btn-accent-dk fw-8 flex-shrik-1",onClick:t[0]||(t[0]=t=>e.query.resource.paged=e.connection.results.pagination.prev),disabled:1==e.query.resource.paged},null,8,y),[[r,"Previous Page"]]),(0,c.withDirectives)(((0,c.openBlock)(),(0,c.createElementBlock)("select",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.query.resource.paged=t),class:"form-control p-1 flex-grow-1"},[((0,c.openBlock)(!0),(0,c.createElementBlock)(c.Fragment,null,(0,c.renderList)(e.connection.results.pagination.pages,(t=>((0,c.openBlock)(),(0,c.createElementBlock)("option",{value:t}," Page "+(0,c.toDisplayString)(t)+" of "+(0,c.toDisplayString)(e.connection.results.pagination.pages),9,h)))),256))])),[[c.vModelSelect,e.query.resource.paged],[r,"Current Page"]]),(0,c.withDirectives)((0,c.createElementVNode)("button",{class:"fa fa-chevron-right btn btn-accent-dk fw-8 flex-shrik-1",onClick:t[2]||(t[2]=t=>e.query.resource.paged=e.connection.results.pagination.next),disabled:e.query.resource.paged==e.connection.results.pagination.next},null,8,D),[[r,"Next Page"]])]),(0,c.createElementVNode)("div",B,[(0,c.createElementVNode)("button",{class:"btn btn-accent-dk rounded-0",onClick:t[3]||(t[3]=(...t)=>e.selectedIDS.selectAll&&e.selectedIDS.selectAll(...t)),disabled:!e.selectedIDS.selectAll}," Select All ",8,I),(0,c.createElementVNode)("button",{class:"btn btn-danger rounded-0 text-white",onClick:t[4]||(t[4]=(...t)=>e.selectedIDS.clearAll&&e.selectedIDS.clearAll(...t)),disabled:!e.selectedIDS.clearAll}," Clear All ",8,E)])])])):(0,c.createCommentVNode)("",!0)}let S=(e,t)=>(0,c.inject)("wp-object-selector");var C={setup:S},V=l(3744);const x=(0,V.Z)(C,[["render",w]]);var N=x,A={setup(e,t){let{connection:l,selectedIDS:c,query:n}=g(e,t);return{connection:l,selectedIDS:c,query:n}},props:f,components:{controls:N}};const q=(0,V.Z)(A,[["render",i],["__scopeId","data-v-a25491f4"]]);var _=q}}]);
//# sourceMappingURL=483.28f2db89.js.map